import{r as k,j as m}from"./index-DYW9UJdq.js";import{C as Y,T as _,I as b,B as W}from"./index-z5QGx03S.js";function h(){}h.prototype={diff:function(e,r){var o,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=u.callback;typeof u=="function"&&(t=u,u={});var i=this;function a(c){return c=i.postProcess(c,u),t?(setTimeout(function(){t(c)},0),!0):c}e=this.castInput(e,u),r=this.castInput(r,u),e=this.removeEmpty(this.tokenize(e,u)),r=this.removeEmpty(this.tokenize(r,u));var l=r.length,f=e.length,s=1,v=l+f;u.maxEditLength!=null&&(v=Math.min(v,u.maxEditLength));var x=(o=u.timeout)!==null&&o!==void 0?o:1/0,g=Date.now()+x,d=[{oldPos:-1,lastComponent:void 0}],p=this.extractCommon(d[0],r,e,0,u);if(d[0].oldPos+1>=f&&p+1>=l)return a(Z(i,d[0].lastComponent,r,e,i.useLongestToken));var C=-1/0,w=1/0;function L(){for(var c=Math.max(C,-s);c<=Math.min(w,s);c+=2){var y=void 0,T=d[c-1],E=d[c+1];T&&(d[c-1]=void 0);var $=!1;if(E){var F=E.oldPos-c;$=E&&0<=F&&F<l}var V=T&&T.oldPos+1<f;if(!$&&!V){d[c]=void 0;continue}if(!V||$&&T.oldPos<E.oldPos?y=i.addToPath(E,!0,!1,0,u):y=i.addToPath(T,!1,!0,1,u),p=i.extractCommon(y,r,e,c,u),y.oldPos+1>=f&&p+1>=l)return a(Z(i,y.lastComponent,r,e,i.useLongestToken));d[c]=y,y.oldPos+1>=f&&(w=Math.min(w,c-1)),p+1>=l&&(C=Math.max(C,c+1))}s++}if(t)(function c(){setTimeout(function(){if(s>v||Date.now()>g)return t();L()||c()},0)})();else for(;s<=v&&Date.now()<=g;){var N=L();if(N)return N}},addToPath:function(e,r,o,u,t){var i=e.lastComponent;return i&&!t.oneChangePerToken&&i.added===r&&i.removed===o?{oldPos:e.oldPos+u,lastComponent:{count:i.count+1,added:r,removed:o,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+u,lastComponent:{count:1,added:r,removed:o,previousComponent:i}}},extractCommon:function(e,r,o,u,t){for(var i=r.length,a=o.length,l=e.oldPos,f=l-u,s=0;f+1<i&&l+1<a&&this.equals(o[l+1],r[f+1],t);)f++,l++,s++,t.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return s&&!t.oneChangePerToken&&(e.lastComponent={count:s,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,f},equals:function(e,r,o){return o.comparator?o.comparator(e,r):e===r||o.ignoreCase&&e.toLowerCase()===r.toLowerCase()},removeEmpty:function(e){for(var r=[],o=0;o<e.length;o++)e[o]&&r.push(e[o]);return r},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function Z(n,e,r,o,u){for(var t=[],i;e;)t.push(e),i=e.previousComponent,delete e.previousComponent,e=i;t.reverse();for(var a=0,l=t.length,f=0,s=0;a<l;a++){var v=t[a];if(v.removed)v.value=n.join(o.slice(s,s+v.count)),s+=v.count;else{if(!v.added&&u){var x=r.slice(f,f+v.count);x=x.map(function(g,d){var p=o[s+d];return p.length>g.length?p:g}),v.value=n.join(x)}else v.value=n.join(r.slice(f,f+v.count));f+=v.count,v.added||(s+=v.count)}}return t}function G(n,e){var r;for(r=0;r<n.length&&r<e.length;r++)if(n[r]!=e[r])return n.slice(0,r);return n.slice(0,r)}function H(n,e){var r;if(!n||!e||n[n.length-1]!=e[e.length-1])return"";for(r=0;r<n.length&&r<e.length;r++)if(n[n.length-(r+1)]!=e[e.length-(r+1)])return n.slice(-r);return n.slice(-r)}function A(n,e,r){if(n.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(n)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return r+n.slice(e.length)}function q(n,e,r){if(!e)return n+r;if(n.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(n)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return n.slice(0,-e.length)+r}function z(n,e){return A(n,e,"")}function I(n,e){return q(n,e,"")}function P(n,e){return e.slice(0,S(n,e))}function S(n,e){var r=0;n.length>e.length&&(r=n.length-e.length);var o=e.length;n.length<e.length&&(o=n.length);var u=Array(o),t=0;u[0]=0;for(var i=1;i<o;i++){for(e[i]==e[t]?u[i]=u[t]:u[i]=t;t>0&&e[i]!=e[t];)t=u[t];e[i]==e[t]&&t++}t=0;for(var a=r;a<n.length;a++){for(;t>0&&n[a]!=e[t];)t=u[t];n[a]==e[t]&&t++}return t}var O="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",K=new RegExp("[".concat(O,"]+|\\s+|[^").concat(O,"]"),"ug"),j=new h;j.equals=function(n,e,r){return r.ignoreCase&&(n=n.toLowerCase(),e=e.toLowerCase()),n.trim()===e.trim()};j.tokenize=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');r=Array.from(e.intlSegmenter.segment(n),function(t){return t.segment})}else r=n.match(K)||[];var o=[],u=null;return r.forEach(function(t){/\s/.test(t)?u==null?o.push(t):o.push(o.pop()+t):/\s/.test(u)?o[o.length-1]==u?o.push(o.pop()+t):o.push(u+t):o.push(t),u=t}),o};j.join=function(n){return n.map(function(e,r){return r==0?e:e.replace(/^\s+/,"")}).join("")};j.postProcess=function(n,e){if(!n||e.oneChangePerToken)return n;var r=null,o=null,u=null;return n.forEach(function(t){t.added?o=t:t.removed?u=t:((o||u)&&Q(r,u,o,t),r=t,o=null,u=null)}),(o||u)&&Q(r,u,o,null),n};function Q(n,e,r,o){if(e&&r){var u=e.value.match(/^\s*/)[0],t=e.value.match(/\s*$/)[0],i=r.value.match(/^\s*/)[0],a=r.value.match(/\s*$/)[0];if(n){var l=G(u,i);n.value=q(n.value,i,l),e.value=z(e.value,l),r.value=z(r.value,l)}if(o){var f=H(t,a);o.value=A(o.value,a,f),e.value=I(e.value,f),r.value=I(r.value,f)}}else if(r)n&&(r.value=r.value.replace(/^\s*/,"")),o&&(o.value=o.value.replace(/^\s*/,""));else if(n&&o){var s=o.value.match(/^\s*/)[0],v=e.value.match(/^\s*/)[0],x=e.value.match(/\s*$/)[0],g=G(s,v);e.value=z(e.value,g);var d=H(z(s,g),x);e.value=I(e.value,d),o.value=A(o.value,s,d),n.value=q(n.value,s,s.slice(0,s.length-d.length))}else if(o){var p=o.value.match(/^\s*/)[0],C=e.value.match(/\s*$/)[0],w=P(C,p);e.value=I(e.value,w)}else if(n){var L=n.value.match(/\s*$/)[0],N=e.value.match(/^\s*/)[0],c=P(L,N);e.value=z(e.value,c)}}var ee=new h;ee.tokenize=function(n){var e=new RegExp("(\\r?\\n)|[".concat(O,"]+|[^\\S\\n\\r]+|[^").concat(O,"]"),"ug");return n.match(e)||[]};var R=new h;R.tokenize=function(n,e){e.stripTrailingCr&&(n=n.replace(/\r\n/g,`
`));var r=[],o=n.split(/(\n|\r\n)/);o[o.length-1]||o.pop();for(var u=0;u<o.length;u++){var t=o[u];u%2&&!e.newlineIsToken?r[r.length-1]+=t:r.push(t)}return r};R.equals=function(n,e,r){return r.ignoreWhitespace?((!r.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!r.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):r.ignoreNewlineAtEof&&!r.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),h.prototype.equals.call(this,n,e,r)};function ne(n,e,r){return R.diff(n,e,r)}var re=new h;re.tokenize=function(n){return n.split(/(\S.+?[.!?])(?=\s+|$)/)};var oe=new h;oe.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)};function J(n){"@babel/helpers - typeof";return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(n)}var D=new h;D.useLongestToken=!0;D.tokenize=R.tokenize;D.castInput=function(n,e){var r=e.undefinedReplacement,o=e.stringifyReplacer,u=o===void 0?function(t,i){return typeof i>"u"?r:i}:o;return typeof n=="string"?n:JSON.stringify(M(n,null,null,u),u,"  ")};D.equals=function(n,e,r){return h.prototype.equals.call(D,n.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),r)};function M(n,e,r,o,u){e=e||[],r=r||[],o&&(n=o(u,n));var t;for(t=0;t<e.length;t+=1)if(e[t]===n)return r[t];var i;if(Object.prototype.toString.call(n)==="[object Array]"){for(e.push(n),i=new Array(n.length),r.push(i),t=0;t<n.length;t+=1)i[t]=M(n[t],e,r,o,u);return e.pop(),r.pop(),i}if(n&&n.toJSON&&(n=n.toJSON()),J(n)==="object"&&n!==null){e.push(n),i={},r.push(i);var a=[],l;for(l in n)Object.prototype.hasOwnProperty.call(n,l)&&a.push(l);for(a.sort(),t=0;t<a.length;t+=1)l=a[t],i[l]=M(n[l],e,r,o,l);e.pop(),r.pop()}else i=n;return i}var B=new h;B.tokenize=function(n){return n.slice()};B.join=B.removeEmpty=function(n){return n};const{TextArea:U}=b,{Title:X}=_;function te(n,e){const r=ne(n,e);return m.jsxs("div",{className:"flex gap-4",children:[m.jsx("div",{className:"flex-1 bg-gray-50 dark:bg-zinc-900 rounded-lg p-2 overflow-x-auto min-h-[180px]",children:r.map((o,u)=>m.jsx("div",{style:{background:o.removed?"#ffe6e6":void 0,color:o.removed?"#d32f2f":void 0},children:o.removed?o.value:o.added?"":o.value},u))}),m.jsx("div",{className:"flex-1 bg-gray-50 dark:bg-zinc-900 rounded-lg p-2 overflow-x-auto min-h-[180px]",children:r.map((o,u)=>m.jsx("div",{style:{background:o.added?"#e6ffe6":void 0,color:o.added?"#388e3c":void 0},children:o.added?o.value:o.removed?"":o.value},u))})]})}const le=()=>{const[n,e]=k.useState(""),[r,o]=k.useState(""),[u,t]=k.useState(!1);return m.jsx("div",{className:"flex justify-center items-center min-h-[70vh]",children:m.jsxs(Y,{className:"w-full max-w-3xl shadow-xl rounded-2xl",bodyStyle:{padding:28},children:[m.jsx(X,{level:4,className:"mb-6 text-center",children:"文本差异比较工具"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[m.jsxs("div",{children:[m.jsx("div",{className:"mb-2 font-semibold",children:"原文本"}),m.jsx(U,{value:n,onChange:i=>e(i.target.value),autoSize:{minRows:8,maxRows:16},placeholder:"请输入原文本..."})]}),m.jsxs("div",{children:[m.jsx("div",{className:"mb-2 font-semibold",children:"对比文本"}),m.jsx(U,{value:r,onChange:i=>o(i.target.value),autoSize:{minRows:8,maxRows:16},placeholder:"请输入对比文本..."})]})]}),m.jsx(W,{type:"primary",className:"mb-6",onClick:()=>t(!0),children:"对比"}),u&&m.jsxs("div",{children:[m.jsx(X,{level:5,className:"mb-2",children:"差异高亮"}),te(n,r)]})]})})};export{le as default};
